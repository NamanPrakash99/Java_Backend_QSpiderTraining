package com.practice;

import javax.persistence.EntityManager;
import javax.persistence.EntityManagerFactory;
import javax.persistence.EntityTransaction;
import javax.persistence.Persistence;
import javax.persistence.Query;

import java.util.List;

public class ProductDao {
	EntityManagerFactory emf=Persistence.createEntityManagerFactory("postgres");
	 EntityManager em = emf.createEntityManager();
     EntityTransaction et = em.getTransaction();
  // ✅ INSERT
     Product p = new Product();
     p.setId(1);
     p.setName("Laptop");
     p.setQuantity(5);
     p.setPrice(50000);

     et.begin();
     em.persist(p);
     et.commit();


     // ✅ FIND BY ID
     Product found = em.find(Product.class, 1);
     System.out.println(found);


     // ✅ UPDATE
     et.begin();
     found.setPrice(55000);
     found.setQuantity(10);
     em.merge(found);
     et.commit();


     // ✅ FIND ALL
     String jpql = "select p from Product p";
     Query q = em.createQuery(jpql);
     List<Product> list = q.getResultList();
     list.forEach(System.out::println);


     // ✅ DELETE
     et.begin();
     em.remove(found);
     et.commit();

     emf.close();
	}
}
