package com.practice;

import javax.persistence.*;
import java.util.List;

public class ProductDao {

    public static void main(String[] args) {

        EntityManagerFactory emf = Persistence.createEntityManagerFactory("postgres");
        EntityManager em = emf.createEntityManager();
        EntityTransaction et = em.getTransaction();

        // To add
        Product p = new Product();
        p.setId(1);
        p.setName("Laptop");
        p.setQuantity(5);
        p.setPrice(50000);

        et.begin();
        em.persist(p);
        et.commit();

        // To find by id
        Product found = em.find(Product.class, 1);
        System.out.println(found);

        // Update
        et.begin();
        found.setPrice(55000);
        found.setQuantity(10);
        em.merge(found);
        et.commit();

        // findAll
        String jpql = "select p from Product p";
        Query q = em.createQuery(jpql);
        List<Product> list = q.getResultList();
        list.forEach(System.out::println);

        // Delete
        et.begin();
        em.remove(found);
        et.commit();

        emf.close();
    }
}
