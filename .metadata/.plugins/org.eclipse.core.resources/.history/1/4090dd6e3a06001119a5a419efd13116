package com.prac;
import java.util.*;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;

public class Employee2 {
	static String url = "jdbc:postgresql://localhost:5432/College";
    static String username = "postgres";
    static String pwd = "2580";

    public static void main(String[] args) throws Exception {

        Scanner sc = new Scanner(System.in);

        System.out.println("Choose Operation:");
        System.out.println("1.Add  2.Delete  3.Update  4.Find");

        int choice = sc.nextInt();

        if(choice == 1){
            addEmployee(sc);
        }
        else if(choice == 2){
            deleteById(sc);
        }
        else if(choice == 3){
            updateById(sc);
        }
        else if(choice == 4){
            findById(sc);
        }
        else{
            System.out.println("Invalid choice");
        }
    }


    static void addEmployee(Scanner sc) throws Exception {
        Connection connect = DriverManager.getConnection(url, username, pwd);
        
        String sql = "INSERT INTO employee VALUES(?,?,?)";
        PreparedStatement pstm = connect.prepareStatement(sql);

        System.out.println("Enter ID:");
        int id=sc.nextInt();
        pstm.setInt(1, id);

        System.out.println("Enter Name:");
        String name=sc.next();
        pstm.setString(2, name);

        System.out.println("Enter Salary:");
        double salary=sc.nextDouble();
        pstm.setDouble(3, salary);

        pstm.execute();
        System.out.println("Employee Inserted!");

        connect.close();
    }
    static void deleteById(Scanner sc) throws Exception {
        Connection connect = DriverManager.getConnection(url, username, pwd);

        String sql = "DELETE FROM employee WHERE id=?";
        PreparedStatement pstm = connect.prepareStatement(sql);

        System.out.println("Enter ID to delete:");
        int id=sc.nextInt();
        pstm.setInt(1, id);

        pstm.execute();
        System.out.println("Employee Deleted!");

        connect.close();
    }
    static void updateById(Scanner sc) throws Exception {
        Connection connect = DriverManager.getConnection(url, username, pwd);

        String sql = "UPDATE FROM employee WHERE id=?";
        PreparedStatement pstm = connect.prepareStatement(sql);

        System.out.println("Enter name to upadte");
        String name=sc.next();
        pstm.setString(1, name);

        pstm.execute();
        System.out.println("Employee Upadted!");

        connect.close();
    }
    static void findById(Scanner sc) throws Exception {
        Connection connect = DriverManager.getConnection(url, username, pwd);

        String sql = "Select * FROM employee WHERE id=?";
        PreparedStatement pstm = connect.prepareStatement(sql);

        System.out.println("Enter ID to find:");
        int id=sc.nextInt();
        pstm.setInt(1, id);
        
        ResultSet rs = pstm.executeQuery();
        
        if(rs.next()){
            System.out.println("ID: "+rs.getInt("id"));
            System.out.println("Name: "+rs.getString("name"));
            System.out.println("Salary: "+rs.getDouble("salary"));
        } else {
            System.out.println("Not found!");
        }

        connect.close();
    }
		
	} catch (Exception e) {
		// TODO Auto-generated catch block
		e.printStackTrace();
	}

}
}
